<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#e74c3c">
    <meta name="description" content="حاسبة شاملة لليرة السورية - تحويل، حساب، ومزج العملات">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="حاسبة الليرة">
    <meta name="mobile-web-app-capable" content="yes">
    
    <title>حاسبة الليرة السورية الشاملة</title>
    
    <!-- روابط الأيقونات للتطبيق -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512x512.png">
    <link rel="apple-touch-icon" href="icon-192x192.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #e74c3c;
            --secondary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --background-color: #f5f7fa;
            --text-color: #333;
            --card-color: #ffffff;
        }
        
        * {
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
        }
        
        /* تذييل التطبيق */
        .app-header {
            background: linear-gradient(to right, var(--secondary-color), #4a6491);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .app-title {
            font-size: 1.8rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .app-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* التبويبات */
        .tabs-container {
            display: flex;
            background-color: #34495e;
            position: sticky;
            top: 108px;
            z-index: 99;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .tab {
            flex: 1;
            padding: 16px 10px;
            text-align: center;
            background-color: #2c3e50;
            color: #bdc3c7;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tab.active {
            background-color: var(--secondary-color);
            color: white;
            border-bottom: 3px solid var(--primary-color);
        }
        
        .tab:hover {
            background-color: #3a5068;
        }
        
        /* محتوى التبويبات */
        .tab-content {
            display: none;
            padding: 20px 15px;
            max-width: 1000px;
            margin: 0 auto;
            min-height: calc(100vh - 180px);
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* بطاقة محتوى */
        .content-card {
            background-color: var(--card-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            color: var(--secondary-color);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #eee;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* التبويب 1: حاسبة التحويل البسيطة */
        .converter-input-group {
            margin-bottom: 25px;
        }
        
        .converter-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--secondary-color);
            font-size: 1.1rem;
        }
        
        .converter-select, .converter-input {
            width: 100%;
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.1rem;
            box-sizing: border-box;
            text-align: center;
            transition: all 0.3s;
            touch-action: manipulation;
            background-color: white;
        }
        
        .converter-select:focus, .converter-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .converter-result {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            border: 1px solid #ddd;
        }
        
        .result-digits {
            background-color: var(--secondary-color);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            direction: ltr;
        }
        
        .result-words {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.1rem;
            color: var(--secondary-color);
            border: 1px solid #e0e0e0;
            line-height: 1.8;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* التبويب 2: حاسبة الكبار */
        .columns-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .currency-column {
            flex: 1;
            min-width: 300px;
            background: #f0f7ff;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid var(--accent-color);
        }
        
        .column-title {
            background-color: var(--accent-color);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: -20px -20px 20px -20px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .currency-list {
            display: grid;
            gap: 15px;
        }
        
        .currency-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: transform 0.2s;
        }
        
        .currency-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.05);
        }
        
        .currency-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .currency-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--secondary-color);
        }
        
        .currency-value {
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--primary-color);
            direction: ltr;
            text-align: center;
            font-family: monospace;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }
        
        .quantity-btn {
            background: var(--success-color);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .quantity-btn:active {
            transform: scale(0.95);
        }
        
        .quantity-btn.minus {
            background: var(--primary-color);
        }
        
        .quantity-display {
            font-size: 1.8rem;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
            color: var(--secondary-color);
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid var(--accent-color);
            direction: ltr;
            font-family: monospace;
        }
        
        .buttons-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 25px 0;
            padding: 20px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 18px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            min-width: 220px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .action-btn:active {
            transform: scale(0.98);
        }
        
        .calculate-btn {
            background: var(--success-color);
            color: white;
            border: 3px solid #2ecc71;
        }
        
        .reset-btn {
            background: var(--primary-color);
            color: white;
            border: 3px solid #c0392b;
        }
        
        .final-result {
            background: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 12px;
            border: 4px solid var(--success-color);
        }
        
        .final-result-title {
            color: var(--secondary-color);
            font-size: 1.5rem;
            margin-bottom: 25px;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .final-values {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .final-value-box {
            flex: 1;
            min-width: 250px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--accent-color);
        }
        
        .final-value-label {
            font-weight: bold;
            font-size: 1.2rem;
            color: #34495e;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .final-value-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
            direction: ltr;
            text-align: center;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 2px solid #ddd;
            font-family: monospace;
        }
        
        .final-value-words {
            font-size: 1.1rem;
            color: var(--secondary-color);
            text-align: center;
            padding: 15px;
            background: #e8f8f5;
            border-radius: 8px;
            border: 1px solid #2ecc71;
            line-height: 1.8;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* التبويب 3: مزج العملات */
        .currency-type-selector {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .currency-option {
            flex: 1;
            text-align: center;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .currency-option:hover {
            background-color: #f9f9f9;
        }
        
        .currency-option.selected {
            border-color: var(--success-color);
            background-color: rgba(46, 204, 113, 0.1);
            font-weight: bold;
        }
        
        .adjustment-options {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .adjustment-option {
            flex: 1;
            min-width: 200px;
            text-align: center;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            background-color: white;
        }
        
        .adjustment-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }
        
        .adjustment-option.selected {
            border-color: var(--accent-color);
            background-color: rgba(52, 152, 219, 0.1);
            font-weight: bold;
        }
        
        .adjustment-option.up {
            border-color: var(--success-color);
        }
        
        .adjustment-option.up.selected {
            background-color: rgba(46, 204, 113, 0.1);
        }
        
        .adjustment-option.down {
            border-color: var(--primary-color);
        }
        
        .adjustment-option.down.selected {
            background-color: rgba(231, 76, 60, 0.1);
        }
        
        .adjustment-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .adjustment-title {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .adjustment-desc {
            color: #666;
            font-size: 0.9rem;
        }
        
        .convert-main-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(to right, var(--accent-color), #2980b9);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            margin: 25px 0;
        }
        
        .convert-main-btn:active {
            transform: scale(0.98);
        }
        
        .remainder-display {
            background-color: #fff8e1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid var(--warning-color);
            display: none;
        }
        
        .remainder-title {
            font-weight: bold;
            color: #e67e22;
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .remainder-amount {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            direction: ltr;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 2px solid var(--warning-color);
        }
        
        .coins-result {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #eee;
            display: none;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .total-amount {
            font-size: 1.8rem;
            color: var(--secondary-color);
            font-weight: bold;
        }
        
        .coins-list {
            max-height: 350px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 10px;
        }
        
        .coin-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 12px;
            background-color: white;
            border-radius: 10px;
            border-right: 5px solid var(--accent-color);
            transition: transform 0.2s;
        }
        
        .coin-item:hover {
            transform: translateX(-5px);
        }
        
        .coin-item.old {
            border-right-color: var(--primary-color);
        }
        
        .coin-item.new {
            border-right-color: var(--success-color);
        }
        
        .coin-name {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .coin-count {
            background-color: var(--accent-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 50px;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .old .coin-count {
            background-color: var(--primary-color);
        }
        
        .new .coin-count {
            background-color: var(--success-color);
        }
        
        .summary {
            display: flex;
            justify-content: space-between;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            border-top: 2px solid #eee;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .summary-item {
            text-align: center;
            flex: 1;
            min-width: 150px;
        }
        
        .summary-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--secondary-color);
        }
        
        .summary-label {
            font-size: 1rem;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        /* مربعات المعلومات */
        .info-box {
            background-color: #fff8e1;
            border-right: 4px solid var(--warning-color);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 1rem;
        }
        
        .info-box h3 {
            color: #e67e22;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* رسائل PWA */
        .offline-status {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            display: none;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .install-prompt {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
        }
        
        .install-prompt button {
            background-color: var(--success-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            margin: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .install-prompt button.close {
            background-color: var(--primary-color);
        }
        
        .install-prompt button:active {
            transform: scale(0.95);
        }
        
        /* تذييل الصفحة */
        .app-footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            margin-top: 20px;
            background-color: white;
        }
        
        /* زر إعادة الضبط في التبويب 1 */
        .simple-converter-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .simple-converter-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            min-width: 180px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .simple-converter-btn.convert {
            background: var(--success-color);
            color: white;
            border: 3px solid #2ecc71;
        }
        
        .simple-converter-btn.reset {
            background: var(--primary-color);
            color: white;
            border: 3px solid #c0392b;
        }
        
        /* تحسينات للهواتف */
        @media (max-width: 768px) {
            .app-title {
                font-size: 1.5rem;
            }
            
            .app-subtitle {
                font-size: 0.9rem;
            }
            
            .tab {
                padding: 14px 8px;
                font-size: 0.9rem;
            }
            
            .tab-content {
                padding: 15px 10px;
            }
            
            .content-card {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            .final-value-number {
                font-size: 1.8rem;
            }
            
            .quantity-btn {
                width: 45px;
                height: 45px;
                font-size: 1.5rem;
            }
            
            .quantity-display {
                font-size: 1.5rem;
                min-width: 70px;
            }
            
            .action-btn {
                min-width: 100%;
                font-size: 1rem;
                padding: 16px;
            }
            
            .buttons-container {
                flex-direction: column;
            }
            
            .currency-column {
                min-width: 100%;
            }
            
            .final-values {
                flex-direction: column;
            }
            
            .final-value-box {
                width: 100%;
            }
            
            .adjustment-options {
                flex-direction: column;
            }
            
            .adjustment-option {
                min-width: 100%;
            }
            
            .simple-converter-buttons {
                flex-direction: column;
            }
            
            .simple-converter-btn {
                min-width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .app-header {
                padding: 15px 10px;
            }
            
            .app-title {
                font-size: 1.3rem;
            }
            
            .tabs-container {
                top: 90px;
            }
            
            .tab {
                padding: 12px 5px;
                font-size: 0.8rem;
            }
            
            .content-card {
                padding: 15px;
            }
            
            .converter-select, .converter-input {
                padding: 14px;
                font-size: 1rem;
            }
            
            .result-digits {
                font-size: 1.1rem;
                padding: 15px;
            }
            
            .result-words {
                font-size: 1rem;
                padding: 15px;
            }
        }
        
        /* تأثيرات اللمس للهواتف */
        @media (hover: none) and (pointer: coarse) {
            button:active, select:active {
                opacity: 0.7;
            }
        }
    </style>
</head>
<body>
    <!-- حالة الاتصال -->
    <div class="offline-status" id="offlineStatus">
        <i class="fas fa-wifi-slash"></i> تطبيق يعمل بدون إنترنت
    </div>
    
    <!-- تذييل التطبيق -->
    <header class="app-header">
        <h1 class="app-title">
            <i class="fas fa-coins"></i> حاسبة الليرة السورية الشاملة
        </h1>
        <p class="app-subtitle">حاسبة متكاملة للتحويل، الحساب، ومزج العملات القديمة والجديدة</p>
    </header>
    
    <!-- التبويبات -->
    <div class="tabs-container">
        <button class="tab active" data-tab="tab1">
            <i class="fas fa-exchange-alt"></i> تحويل بسيط
        </button>
        <button class="tab" data-tab="tab2">
            <i class="fas fa-calculator"></i> حاسبة المدخرات
        </button>
        <button class="tab" data-tab="tab3">
            <i class="fas fa-random"></i> مزج العملات
        </button>
    </div>
    
    <!-- محتوى التبويب 1: حاسبة التحويل البسيطة -->
    <div class="tab-content active" id="tab1">
        <div class="content-card">
            <h2 class="section-title">
                <i class="fas fa-exchange-alt"></i> تحويل سريع بين القديم والجديد
            </h2>
            
            <div class="converter-input-group">
                <label class="converter-label">نوع التحويل:</label>
                <select class="converter-select" id="conversionType">
                    <option value="oldToNew">الليرات القديمة ← الليرات الجديدة</option>
                    <option value="newToOld">الليرات الجديدة ← الليرات القديمة</option>
                </select>
            </div>
            
            <div class="converter-input-group">
                <label class="converter-label" id="amountLabel">المبلغ المراد تحويله:</label>
                <input type="number" class="converter-input" id="amount" 
                       placeholder="أدخل المبلغ هنا" min="0" step="1" inputmode="numeric" value="">
            </div>
            
            <div class="converter-input-group" id="adjustmentSection" style="display: none;">
                <label class="converter-label">طريقة جبر الباقي:</label>
                <div class="adjustment-options">
                    <div class="adjustment-option up selected" data-adjustment="up">
                        <div class="adjustment-icon">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="adjustment-title">الجبر بالزيادة</div>
                        <div class="adjustment-desc">إضافة باقي المبلغ لأقرب فئة</div>
                    </div>
                    <div class="adjustment-option down" data-adjustment="down">
                        <div class="adjustment-icon">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="adjustment-title">الجبر بالنقصان</div>
                        <div class="adjustment-desc">إزالة باقي المبلغ لأقرب فئة</div>
                    </div>
                </div>
            </div>
            
            <div class="simple-converter-buttons">
                <button class="simple-converter-btn convert" onclick="calculateSimple()">
                    <i class="fas fa-sync-alt"></i> تحويل
                </button>
                <button class="simple-converter-btn reset" onclick="resetTab1()">
                    <i class="fas fa-trash-alt"></i> إعادة ضبط
                </button>
            </div>
            
            <div class="converter-result">
                <div class="result-digits" id="resultDigits">
                    أدخل المبلغ لعرض نتيجة التحويل
                </div>
                <div class="result-words" id="resultWords">
                    سيظهر المبلغ كتابةً هنا
                </div>
            </div>
            
            <div class="info-box">
                <h3><i class="fas fa-lightbulb"></i> معلومة مهمة:</h3>
                <p>معادلة التحويل: 100 ليرة قديمة = 1 ليرة جديدة</p>
                <p>لا توجد فواصل عشرية في الليرات الجديدة</p>
                <p>التطبيق يعمل بدون إنترنت</p>
            </div>
        </div>
    </div>
    
    <!-- محتوى التبويب 2: حاسبة المدخرات -->
    <div class="tab-content" id="tab2">
        <div class="content-card">
            <h2 class="section-title">
                <i class="fas fa-calculator"></i> حاسبة تفصيلية للعملات
            </h2>
            
            <div class="columns-container">
                <!-- العمود الأول: العملة القديمة -->
                <div class="currency-column">
                    <div class="column-title">الفئات القديمة</div>
                    <div class="currency-list" id="oldCurrencyList">
                        <!-- سيتم ملؤها بواسطة الجافاسكريبت -->
                    </div>
                </div>
                
                <!-- العمود الثاني: العملة الجديدة -->
                <div class="currency-column">
                    <div class="column-title">الفئات الجديدة</div>
                    <div class="currency-list" id="newCurrencyList">
                        <!-- سيتم ملؤها بواسطة الجافاسكريبت -->
                    </div>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="action-btn calculate-btn" onclick="calculateTotals()">
                    <i class="fas fa-sync-alt"></i> احسب الإجمالي
                </button>
                <button class="action-btn reset-btn" onclick="resetTab2()">
                    <i class="fas fa-trash-alt"></i> إعادة ضبط
                </button>
            </div>
            
            <div class="final-result">
                <div class="final-result-title">الإجمالي النهائي</div>
                <div class="final-values">
                    <div class="final-value-box">
                        <div class="final-value-label">الليرات القديمة:</div>
                        <div class="final-value-number" id="finalOld">0</div>
                        <div class="final-value-words" id="finalOldWords">صفر ليرة فقط</div>
                    </div>
                    <div class="final-value-box">
                        <div class="final-value-label">الليرات الجديدة:</div>
                        <div class="final-value-number" id="finalNew">0</div>
                        <div class="final-value-words" id="finalNewWords">صفر ليرة فقط</div>
                    </div>
                </div>
            </div>
            
            <div class="info-box">
                <h3><i class="fas fa-info-circle"></i> طريقة الاستخدام:</h3>
                <p>١. اضغط على زر + لزيادة الكمية<br>
                ٢. اضغط على زر - لتقليل الكمية<br>
                ٣. اضغط على زر "احسب الإجمالي"<br>
                ٤. شاهد النتيجة بالأرقام والكلمات</p>
            </div>
        </div>
    </div>
    
    <!-- محتوى التبويب 3: مزج العملات -->
    <div class="tab-content" id="tab3">
        <div class="content-card">
            <h2 class="section-title">
                <i class="fas fa-random"></i> مزج العملات للمحلات
            </h2>
            
            <div class="converter-input-group">
                <label class="converter-label">المبلغ المراد تحويله:</label>
                <input type="number" class="converter-input" id="mixedAmount" 
                       min="0" step="1" placeholder="أدخل المبلغ هنا" value="">
            </div>
            
            <div class="converter-input-group">
                <label class="converter-label">نوع العملة المدخلة:</label>
                <div class="currency-type-selector">
                    <div class="currency-option selected" data-type="old">
                        <i class="fas fa-history"></i>
                        <div>ليرة قديمة</div>
                    </div>
                    <div class="currency-option" data-type="new">
                        <i class="fas fa-star"></i>
                        <div>ليرة جديدة</div>
                    </div>
                </div>
            </div>
            
            <div class="converter-input-group">
                <label class="converter-label">طريقة جبر الباقي:</label>
                <div class="adjustment-options">
                    <div class="adjustment-option up selected" data-adjustment="up">
                        <div class="adjustment-icon">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="adjustment-title">الجبر بالزيادة</div>
                        <div class="adjustment-desc">إضافة باقي المبلغ لأقرب فئة</div>
                    </div>
                    <div class="adjustment-option down" data-adjustment="down">
                        <div class="adjustment-icon">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="adjustment-title">الجبر بالنقصان</div>
                        <div class="adjustment-desc">إزالة باقي المبلغ لأقرب فئة</div>
                    </div>
                </div>
            </div>
            
            <div class="simple-converter-buttons">
                <button class="simple-converter-btn convert" onclick="convertMixedAmount()">
                    <i class="fas fa-sync-alt"></i> مزج المبلغ
                </button>
                <button class="simple-converter-btn reset" onclick="resetTab3()">
                    <i class="fas fa-trash-alt"></i> إعادة ضبط
                </button>
            </div>
            
            <div class="remainder-display" id="remainderDisplay">
                <div class="remainder-title">
                    <i class="fas fa-exclamation-triangle"></i> الباقي الذي تم تجبيره
                </div>
                <div id="remainderText">
                    <!-- سيتم ملؤها بالنتيجة -->
                </div>
                <div class="remainder-amount" id="remainderAmount">
                    <!-- سيتم ملؤها بالمبلغ -->
                </div>
            </div>
            
            <div class="coins-result" id="mixedResultBox">
                <div class="result-header">
                    <div>
                        <div style="color: #7f8c8d; font-size: 0.9rem;">المبلغ المدخل</div>
                        <div class="total-amount" id="inputMixedAmount">0</div>
                    </div>
                    <div>
                        <i class="fas fa-arrow-right" style="font-size: 1.5rem; color: var(--accent-color);"></i>
                    </div>
                    <div>
                        <div style="color: #7f8c8d; font-size: 0.9rem;">المبلغ بعد الجبر</div>
                        <div class="total-amount" id="adjustedMixedAmount">0</div>
                    </div>
                </div>
                
                <div class="coins-list" id="mixedCoinsList">
                    <div style="text-align: center; padding: 40px 20px; color: #95a5a6;">
                        <i class="fas fa-coins" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <p>سيظهر هنا مزيج العملات بعد التحويل</p>
                    </div>
                </div>
                
                <div class="summary">
                    <div class="summary-item">
                        <div class="summary-value" id="oldMixedCoinsCount">0</div>
                        <div class="summary-label">عملة قديمة</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="totalMixedCoinsCount">0</div>
                        <div class="summary-label">إجمالي العملات</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="newMixedCoinsCount">0</div>
                        <div class="summary-label">عملة جديدة</div>
                    </div>
                </div>
            </div>
            
            <div class="info-box">
                <h3><i class="fas fa-lightbulb"></i> كيف يعمل مزج العملات؟</h3>
                <p>• التطبيق يحول المبلغ إلى أفضل مزيج من العملات لتسهيل التعامل في المحلات<br>
                • عند وجود باقي لا يقبل القسمة، يمكنك اختيار جبره بالزيادة أو النقصان<br>
                • الجبر بالزيادة: إضافة باقي المبلغ لتصبح قابلة للقسمة على الفئات المتاحة<br>
                • الجبر بالنقصان: إزالة باقي المبلغ لتصبح قابلة للقسمة على الفئات المتاحة</p>
            </div>
        </div>
    </div>
    
    <!-- تذييل الصفحة -->
    <footer class="app-footer">
        <p>تطبيق حاسبة الليرة السورية الشاملة - يعمل بدون إنترنت</p>
        <p>yamenmohamad@gmail.com</p>
    </footer>
    
    <!-- نافذة تثبيت PWA -->
    <div class="install-prompt" id="installPrompt">
        <p>هل تريد تثبيت تطبيق حاسبة الليرة على جهازك؟</p>
        <button onclick="installApp()">تثبيت التطبيق</button>
        <button class="close" onclick="closeInstallPrompt()">لاحقاً</button>
    </div>

    <script>
        // ===== متغيرات عامة للتطبيق =====
        let deferredPrompt;
        let currentTab = 'tab1';
        let lastActiveTab = 'tab1';
        
        // إعدادات الجبر للتبويب 1
        let simpleConverterAdjustment = 'up';
        
        // ===== إدارة التبويبات =====
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // إذا كان نفس التبويب، لا تفعل شيئاً
                if (tabId === currentTab) return;
                
                // تفريغ التبويب السابق
                resetTabOnLeave(lastActiveTab);
                
                // إزالة النشاط من جميع التبويبات
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // إضافة النشاط للتبويب المحدد
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
                
                // تحديث التبويبات النشطة
                lastActiveTab = currentTab;
                currentTab = tabId;
                
                // حفظ التبويب النشط في الذاكرة المحلية
                localStorage.setItem('activeTab', tabId);
            });
        });
        
        // ===== دوال تفريغ التبويبات عند المغادرة =====
        function resetTabOnLeave(tabId) {
            switch(tabId) {
                case 'tab1':
                    resetTab1();
                    break;
                case 'tab2':
                    resetTab2();
                    break;
                case 'tab3':
                    resetTab3();
                    break;
            }
        }
        
        // ===== دوال إعادة الضبط لكل تبويب =====
        function resetTab1() {
            document.getElementById('amount').value = '';
            document.getElementById('resultDigits').innerHTML = 'أدخل المبلغ لعرض نتيجة التحويل';
            document.getElementById('resultWords').innerHTML = 'سيظهر المبلغ كتابةً هنا';
            
            // إعادة ضبط الجبر للقيمة الافتراضية
            simpleConverterAdjustment = 'up';
            document.querySelectorAll('#adjustmentSection .adjustment-option').forEach(opt => {
                opt.classList.remove('selected');
                if(opt.getAttribute('data-adjustment') === 'up') {
                    opt.classList.add('selected');
                }
            });
            
            // إخفاء قسم الجبر
            document.getElementById('adjustmentSection').style.display = 'none';
        }
        
        function resetTab2() {
            quantities = {
                old: Array(currencyData.old.length).fill(0),
                new: Array(currencyData.new.length).fill(0)
            };
            
            // تحديث العرض
            currencyData.old.forEach((_, index) => updateDisplay('old', index));
            currencyData.new.forEach((_, index) => updateDisplay('new', index));
            
            // إعادة ضبط النتائج
            document.getElementById('finalOld').textContent = '0';
            document.getElementById('finalNew').textContent = '0';
            document.getElementById('finalOldWords').textContent = 'صفر ليرة فقط';
            document.getElementById('finalNewWords').textContent = 'صفر ليرة فقط';
        }
        
        function resetTab3() {
            document.getElementById('mixedAmount').value = '';
            document.getElementById('remainderDisplay').style.display = 'none';
            document.getElementById('mixedResultBox').style.display = 'none';
            
            // إعادة ضبط إلى القيم الافتراضية
            selectedMixedCurrencyType = 'old';
            selectedAdjustment = 'up';
            
            document.querySelectorAll('.currency-option').forEach(opt => {
                opt.classList.remove('selected');
                if(opt.getAttribute('data-type') === 'old') {
                    opt.classList.add('selected');
                }
            });
            
            document.querySelectorAll('.adjustment-option').forEach(opt => {
                opt.classList.remove('selected');
                if(opt.getAttribute('data-adjustment') === 'up') {
                    opt.classList.add('selected');
                }
            });
        }
        
        // ===== التبويب 1: حاسبة التحويل البسيطة مع الجبر =====
        function numberToArabicWords(num) {
            if (num === 0) return "صفر";
            
            const units = ['', 'واحد', 'اثنان', 'ثلاثة', 'أربعة', 'خمسة', 'ستة', 'سبعة', 'ثمانية', 'تسعة'];
            const tens = ['', 'عشرة', 'عشرون', 'ثلاثون', 'أربعون', 'خمسون', 'ستون', 'سبعون', 'ثمانون', 'تسعون'];
            const teens = ['عشرة', 'أحد عشر', 'اثنا عشر', 'ثلاثة عشر', 'أربعة عشر', 'خمسة عشر', 'ستة عشر', 'سبعة عشر', 'ثمانية عشر', 'تسعة عشر'];
            const hundreds = ['', 'مائة', 'مائتان', 'ثلاثمائة', 'أربعمائة', 'خمسمائة', 'ستمائة', 'سبعمائة', 'ثمانمائة', 'تسعمائة'];
            
            let result = '';
            let n = Math.floor(num);
            
            // المليارات
            if (n >= 1000000000) {
                const billionsPart = Math.floor(n / 1000000000);
                if (billionsPart === 1) {
                    result += 'مليار ';
                } else if (billionsPart === 2) {
                    result += 'ملياران ';
                } else if (billionsPart > 2 && billionsPart < 11) {
                    result += numberToArabicWords(billionsPart) + ' مليارات ';
                } else {
                    result += numberToArabicWords(billionsPart) + ' ملياراً ';
                }
                n %= 1000000000;
                if (n > 0) result += 'و ';
            }
            
            // الملايين
            if (n >= 1000000) {
                const millionsPart = Math.floor(n / 1000000);
                if (millionsPart === 1) {
                    result += 'مليون ';
                } else if (millionsPart === 2) {
                    result += 'مليونان ';
                } else if (millionsPart > 2 && millionsPart < 11) {
                    result += numberToArabicWords(millionsPart) + ' ملايين ';
                } else {
                    result += numberToArabicWords(millionsPart) + ' مليوناً ';
                }
                n %= 1000000;
                if (n > 0) result += 'و ';
            }
            
            // الآلاف
            if (n >= 1000) {
                const thousandsPart = Math.floor(n / 1000);
                if (thousandsPart === 1) {
                    result += 'ألف ';
                } else if (thousandsPart === 2) {
                    result += 'ألفان ';
                } else if (thousandsPart > 2 && thousandsPart < 11) {
                    result += numberToArabicWords(thousandsPart) + ' آلاف ';
                } else {
                    result += numberToArabicWords(thousandsPart) + ' ألف  ';
                }
                n %= 1000;
                if (n > 0) result += 'و ';
            }
            
            // المئات
            if (n >= 100) {
                const hundredsPart = Math.floor(n / 100);
                result += hundreds[hundredsPart] + ' ';
                n %= 100;
                if (n > 0) result += 'و ';
            }
            
            // العشرات والآحاد
            if (n > 0) {
                if (n >= 10 && n <= 19) {
                    result += teens[n - 10] + ' ';
                } else {
                    const unitsPart = n % 10;
                    const tensPart = Math.floor(n / 10);
                    
                    if (unitsPart > 0 && tensPart > 0) {
                        result += units[unitsPart] + ' و' + tens[tensPart] + ' ';
                    } else if (unitsPart > 0) {
                        result += units[unitsPart] + ' ';
                    } else if (tensPart > 0) {
                        result += tens[tensPart] + ' ';
                    }
                }
            }
            
            // التعامل مع الكسور
            const decimal = Math.round((num - Math.floor(num)) * 100);
            if (decimal > 0) {
                result = result.trim();
                result += ' فاصلة ' + numberToArabicWords(decimal);
            }
            
            return result.trim();
        }
        
        function getCurrencyName(amount, isOldCurrency) {
            const baseName = isOldCurrency ? 'سورية قديمة' : 'سورية جديدة';
            
            if (amount === 1) {
                return 'ليرة ' + baseName;
            } else if (amount === 2) {
                return 'ليرتان ' + baseName;
            } else if (amount > 2 && amount < 11) {
                return 'ليرات ' + baseName;
            } else if (amount >= 11) {
                return 'ليرة ' + baseName;
            }
            
            return 'ليرة ' + baseName;
        }
        
        function updateLabels() {
            const conversionType = document.getElementById('conversionType').value;
            const label = document.getElementById('amountLabel');
            const adjustmentSection = document.getElementById('adjustmentSection');
            
            if (conversionType === 'oldToNew') {
                label.textContent = 'المبلغ المراد تحويله (الليرات القديمة):';
                document.getElementById('amount').placeholder = 'أدخل عدد الليرات القديمة';
                // إظهار قسم الجبر فقط للتحويل من قديم إلى جديد
                adjustmentSection.style.display = 'block';
            } else {
                label.textContent = 'المبلغ المراد تحويله (الليرات الجديدة):';
                document.getElementById('amount').placeholder = 'أدخل عدد الليرات الجديدة';
                // إخفاء قسم الجبر للتحويل من جديد إلى قديم
                adjustmentSection.style.display = 'none';
            }
        }
        
        // تهيئة أحداث الجبر للتبويب 1
        function initSimpleConverterAdjustment() {
            document.querySelectorAll('#adjustmentSection .adjustment-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('#adjustmentSection .adjustment-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    simpleConverterAdjustment = option.getAttribute('data-adjustment');
                    
                    // إذا كان هناك مبلغ، أعد حساب النتيجة
                    if (document.getElementById('amount').value) {
                        calculateSimple();
                    }
                });
            });
        }
        
        function calculateSimple() {
            const amountInput = document.getElementById('amount');
            const conversionType = document.getElementById('conversionType').value;
            const resultDigitsDiv = document.getElementById('resultDigits');
            const resultWordsDiv = document.getElementById('resultWords');
            const amount = parseFloat(amountInput.value);
            
            if (!amount || amount < 0) {
                resultDigitsDiv.innerHTML = 'أدخل المبلغ لعرض نتيجة التحويل';
                resultWordsDiv.innerHTML = 'سيظهر المبلغ كتابةً هنا';
                return;
            }
            
            let originalAmount = amount;
            let adjustedAmount = amount;
            let adjustmentAmount = 0;
            let hasAdjustment = false;
            
            // التحويل من قديم إلى جديد مع الجبر
            if (conversionType === 'oldToNew') {
                const remainder = amount % 100;
                
                if (remainder > 0) {
                    hasAdjustment = true;
                    
                    if (simpleConverterAdjustment === 'up') {
                        // الجبر بالزيادة
                        adjustmentAmount = 100 - remainder;
                        adjustedAmount = amount + adjustmentAmount;
                    } else {
                        // الجبر بالنقصان
                        adjustmentAmount = remainder;
                        adjustedAmount = amount - adjustmentAmount;
                    }
                }
                
                // التحويل إلى جديد (بدون فواصل عشرية)
                let convertedAmount = Math.floor(adjustedAmount / 100);
                
                // تنسيق الأرقام
                const formattedOriginal = originalAmount.toLocaleString('ar-EG');
                const formattedAdjusted = adjustedAmount.toLocaleString('ar-EG');
                const formattedConverted = convertedAmount.toLocaleString('ar-EG');
                
                // تحويل الأرقام إلى كلمات
                let originalInWords = numberToArabicWords(originalAmount) + ' ليرة سورية قديمة';
                let adjustedInWords = numberToArabicWords(adjustedAmount) + ' ليرة سورية قديمة';
                let convertedInWords = numberToArabicWords(convertedAmount) + ' ليرة سورية جديدة';
                
                // عرض النتيجة
                if (hasAdjustment) {
                    resultDigitsDiv.innerHTML = `
                        <div style="margin-bottom: 10px; font-size: 1.2rem;">${formattedOriginal} ليرة قديمة</div>
                        <div style="font-size: 1rem; margin: 5px 0; color: ${simpleConverterAdjustment === 'up' ? '#27ae60' : '#e74c3c'};">
                            <i class="fas fa-${simpleConverterAdjustment === 'up' ? 'arrow-up' : 'arrow-down'}"></i>
                            تم الجبر ${simpleConverterAdjustment === 'up' ? 'بالزيادة' : 'بالنقصان'} بمقدار ${adjustmentAmount.toLocaleString()} ليرة قديمة
                        </div>
                        <div style="font-size: 1rem; margin: 5px 0;">أصبح: ${formattedAdjusted} ليرة قديمة</div>
                        <div style="font-size: 1.5rem; margin: 10px 0; color: var(--accent-color);">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div style="margin-top: 10px; color: var(--primary-color); font-size: 1.5rem;">${formattedConverted} ليرة جديدة</div>
                    `;
                    
                    resultWordsDiv.innerHTML = `
                        <div style="margin-bottom: 10px;"><strong>${originalInWords}</strong></div>
                        <div style="margin: 5px 0; font-size: 0.9rem; color: ${simpleConverterAdjustment === 'up' ? '#27ae60' : '#e74c3c'}">
                            تم الجبر ${simpleConverterAdjustment === 'up' ? 'بالزيادة' : 'بالنقصان'} بمقدار ${numberToArabicWords(adjustmentAmount)} ليرة قديمة
                        </div>
                        <div style="margin: 5px 0;"><strong>${adjustedInWords}</strong></div>
                        <div style="margin: 10px 0; font-size: 1rem; color: #7f8c8d;">تساوي</div>
                        <div style="margin-top: 10px;"><strong>${convertedInWords}</strong></div>
                    `;
                } else {
                    resultDigitsDiv.innerHTML = `
                        <div style="margin-bottom: 10px; font-size: 1.2rem;">${formattedOriginal} ليرة قديمة</div>
                        <div style="font-size: 1.5rem; margin: 10px 0; color: var(--accent-color);">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div style="margin-top: 10px; color: var(--primary-color); font-size: 1.5rem;">${formattedConverted} ليرة جديدة</div>
                    `;
                    
                    resultWordsDiv.innerHTML = `
                        <div style="margin-bottom: 10px;"><strong>${originalInWords}</strong></div>
                        <div style="margin: 10px 0; font-size: 1rem; color: #7f8c8d;">تساوي</div>
                        <div style="margin-top: 10px;"><strong>${convertedInWords}</strong></div>
                    `;
                }
            } else {
                // التحويل من جديد إلى قديم (لا يوجد جبر هنا)
                let convertedAmount = amount * 100;
                
                // تنسيق الأرقام
                const formattedOriginal = amount.toLocaleString('ar-EG');
                const formattedConverted = convertedAmount.toLocaleString('ar-EG');
                
                // تحويل الأرقام إلى كلمات
                let originalInWords = numberToArabicWords(amount) + ' ليرة سورية جديدة';
                let convertedInWords = numberToArabicWords(convertedAmount) + ' ليرة سورية قديمة';
                
                resultDigitsDiv.innerHTML = `
                    <div style="margin-bottom: 10px; font-size: 1.2rem;">${formattedOriginal} ليرة جديدة</div>
                    <div style="font-size: 1.5rem; margin: 10px 0; color: var(--accent-color);">
                        <i class="fas fa-arrow-down"></i>
                    </div>
                    <div style="margin-top: 10px; color: var(--primary-color); font-size: 1.5rem;">${formattedConverted} ليرة قديمة</div>
                `;
                
                resultWordsDiv.innerHTML = `
                    <div style="margin-bottom: 10px;"><strong>${originalInWords}</strong></div>
                    <div style="margin: 10px 0; font-size: 1rem; color: #7f8c8d;">تساوي</div>
                    <div style="margin-top: 10px;"><strong>${convertedInWords}</strong></div>
                `;
            }
        }
        
        // ===== التبويب 2: حاسبة الكبار =====
        const currencyData = {
            old: [
                { name: "مئة ليرة قديمة", value: 100 },
                { name: "خمسمائة ليرة قديمة", value: 500 },
                { name: "ألف ليرة قديمة", value: 1000 },
                { name: "ألفان ليرة قديمة", value: 2000 },
                { name: "خمسة آلاف ليرة قديمة", value: 5000 }
            ],
            new: [
                { name: "عشر ليرات جديدة", value: 10 },
                { name: "خمس وعشرون ليرة جديدة", value: 25 },
                { name: "خمسون ليرة جديدة", value: 50 },
                { name: "مئة ليرة جديدة", value: 100 },
                { name: "مئتان ليرة جديدة", value: 200 },
                { name: "خمسمائة ليرة جديدة", value: 500 }
            ]
        };
        
        let quantities = {
            old: Array(currencyData.old.length).fill(0),
            new: Array(currencyData.new.length).fill(0)
        };
        
        function initCurrencyCalculator() {
            const oldList = document.getElementById('oldCurrencyList');
            const newList = document.getElementById('newCurrencyList');
            
            oldList.innerHTML = '';
            newList.innerHTML = '';
            
            // إنشاء قائمة العملة القديمة
            currencyData.old.forEach((currency, index) => {
                const item = document.createElement('div');
                item.className = 'currency-item';
                item.innerHTML = `
                    <div class="currency-info">
                        <span class="currency-name">${currency.name}</span>
                        <span class="currency-value">${currency.value.toLocaleString('en-US')}</span>
                    </div>
                    <div class="quantity-control">
                        <button class="quantity-btn minus" onclick="decrement('old', ${index})">-</button>
                        <span class="quantity-display" id="qty-old-${index}">0</span>
                        <button class="quantity-btn" onclick="increment('old', ${index})">+</button>
                    </div>
                `;
                oldList.appendChild(item);
            });
            
            // إنشاء قائمة العملة الجديدة
            currencyData.new.forEach((currency, index) => {
                const item = document.createElement('div');
                item.className = 'currency-item';
                item.innerHTML = `
                    <div class="currency-info">
                        <span class="currency-name">${currency.name}</span>
                        <span class="currency-value">${currency.value.toLocaleString('en-US')}</span>
                    </div>
                    <div class="quantity-control">
                        <button class="quantity-btn minus" onclick="decrement('new', ${index})">-</button>
                        <span class="quantity-display" id="qty-new-${index}">0</span>
                        <button class="quantity-btn" onclick="increment('new', ${index})">+</button>
                    </div>
                `;
                newList.appendChild(item);
            });
        }
        
        function increment(type, index) {
            quantities[type][index]++;
            updateDisplay(type, index);
        }
        
        function decrement(type, index) {
            if (quantities[type][index] > 0) {
                quantities[type][index]--;
                updateDisplay(type, index);
            }
        }
        
        function updateDisplay(type, index) {
            const element = document.getElementById(`qty-${type}-${index}`);
            if (element) {
                element.textContent = quantities[type][index];
            }
        }
        
        function numberToArabicWordsDetailed(num) {
            if (num === 0) return "صفر ليرة فقط";
            
            const integerPart = Math.floor(num);
            
            // قوائم الكلمات
            const units = ['', 'واحد', 'اثنان', 'ثلاثة', 'أربعة', 'خمسة', 'ستة', 'سبعة', 'ثمانية', 'تسعة'];
            const tens = ['', 'عشرة', 'عشرون', 'ثلاثون', 'أربعون', 'خمسون', 'ستون', 'سبعون', 'ثمانون', 'تسعون'];
            const teens = ['عشرة', 'أحد عشر', 'اثنا عشر', 'ثلاثة عشر', 'أربعة عشر', 'خمسة عشر', 'ستة عشر', 'سبعة عشر', 'ثمانية عشر', 'تسعة عشر'];
            const hundreds = ['', 'مائة', 'مائتان', 'ثلاثمائة', 'أربعمائة', 'خمسمائة', 'ستمائة', 'سبعمائة', 'ثمانمائة', 'تسعمائة'];
            
            let result = '';
            let n = integerPart;
            
            // الملايين
            if (n >= 1000000) {
                const millionsPart = Math.floor(n / 1000000);
                if (millionsPart === 1) {
                    result += 'مليون ';
                } else if (millionsPart === 2) {
                    result += 'مليونان ';
                } else if (millionsPart > 2 && millionsPart < 11) {
                    result += units[millionsPart] + ' ملايين ';
                } else {
                    result += numberToArabicWords(millionsPart) + ' مليوناً ';
                }
                n %= 1000000;
                if (n > 0) result += 'و ';
            }
            
            // الآلاف
            if (n >= 1000) {
                const thousandsPart = Math.floor(n / 1000);
                if (thousandsPart === 1) {
                    result += 'ألف ';
                } else if (thousandsPart === 2) {
                    result += 'ألفان ';
                } else if (thousandsPart > 2 && thousandsPart < 11) {
                    result += units[thousandsPart] + ' آلاف ';
                } else {
                    result += numberToArabicWords(thousandsPart) + ' ألف  ';
                }
                n %= 1000;
                if (n > 0) result += 'و ';
            }
            
            // المئات
            if (n >= 100) {
                const hundredsPart = Math.floor(n / 100);
                result += hundreds[hundredsPart] + ' ';
                n %= 100;
                if (n > 0) result += 'و ';
            }
            
            // العشرات والآحاد
            if (n > 0) {
                if (n >= 10 && n <= 19) {
                    result += teens[n - 10] + ' ';
                } else {
                    const unitsPart = n % 10;
                    const tensPart = Math.floor(n / 10);
                    
                    if (unitsPart > 0 && tensPart > 0) {
                        result += units[unitsPart] + ' و' + tens[tensPart] + ' ';
                    } else if (unitsPart > 0) {
                        result += units[unitsPart] + ' ';
                    } else if (tensPart > 0) {
                        result += tens[tensPart] + ' ';
                    }
                }
            }
            
            // إضافة العملة
            if (integerPart === 1) {
                result += ' ليرة';
            } else if (integerPart === 2) {
                result += ' ليرتان';
            } else if (integerPart > 2 && integerPart < 11) {
                result += ' ليرات';
            } else {
                result += ' ليرة';
            }
            
            return result.trim() + ' فقط';
        }
        
        function calculateTotals() {
            let totalOld = 0;
            let totalNew = 0;
            
            // حساب إجمالي العملة القديمة
            currencyData.old.forEach((currency, index) => {
                totalOld += currency.value * quantities.old[index];
            });
            
            // حساب إجمالي العملة الجديدة
            currencyData.new.forEach((currency, index) => {
                totalNew += currency.value * quantities.new[index];
            });
            
            // التحويل بين العملات
            const oldInNew = Math.floor(totalOld / 100); // بدون فواصل عشرية
            const newInOld = totalNew * 100;
            
            // الإجماليات النهائية
            const finalOld = Math.round(totalOld + newInOld);
            const finalNew = totalNew + oldInNew;
            
            // تحديث العرض بالأرقام الإنجليزية
            document.getElementById('finalOld').textContent = formatNumber(finalOld);
            document.getElementById('finalNew').textContent = formatNumber(finalNew);
            
            // تحديث العرض بالكلمات العربية
            document.getElementById('finalOldWords').textContent = numberToArabicWordsDetailed(finalOld);
            document.getElementById('finalNewWords').textContent = numberToArabicWordsDetailed(finalNew);
        }
        
        // ===== التبويب 3: مزج العملات =====
        let selectedMixedCurrencyType = 'old';
        let selectedAdjustment = 'up';
        
        function initMixedConverter() {
            // اختيار نوع العملة
            document.querySelectorAll('.currency-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.currency-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    selectedMixedCurrencyType = option.getAttribute('data-type');
                });
            });
            
            // اختيار طريقة الجبر
            document.querySelectorAll('.adjustment-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.adjustment-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    selectedAdjustment = option.getAttribute('data-adjustment');
                });
            });
            
            // السماح بالضغط على زر Enter
            document.getElementById('mixedAmount').addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    convertMixedAmount();
                }
            });
        }
        
        function convertMixedAmount() {
            const amountInput = document.getElementById('mixedAmount');
            const amount = parseFloat(amountInput.value);
            
            if (isNaN(amount) || amount <= 0) {
                alert('يرجى إدخال مبلغ صحيح أكبر من الصفر');
                amountInput.focus();
                return;
            }
            
            if (amount > 1000000) {
                alert('المبلغ كبير جداً. يرجى إدخال مبلغ أقل من مليون');
                amountInput.focus();
                return;
            }
            
            const result = convertToMixedCoins(amount, selectedMixedCurrencyType === 'old', selectedAdjustment);
            displayMixedResults(result);
        }
        
        function convertToMixedCoins(amount, isOldCurrency, adjustment) {
            // إذا كان المبلغ بالعملة الجديدة، نحوله إلى قديمة للحسابات (1 جديدة = 100 قديمة)
            let amountInOld = isOldCurrency ? amount : amount * 100;
            let originalAmountInOld = amountInOld;
            
            // تحديد أصغر عملة قديمة (100 ليرة)
            const smallestCoin = 100;
            
            // حساب الباقي
            let remainder = amountInOld % smallestCoin;
            
            // تطبيق الجبر المطلوب
            let adjustedAmount = amountInOld;
            let adjustmentAmount = 0;
            
            if (remainder > 0) {
                if (adjustment === 'up') {
                    // الجبر بالزيادة
                    adjustmentAmount = smallestCoin - remainder;
                    adjustedAmount = amountInOld + adjustmentAmount;
                } else {
                    // الجبر بالنقصان
                    adjustmentAmount = remainder;
                    adjustedAmount = amountInOld - adjustmentAmount;
                }
            }
            
            // الآن نقوم بتحويل المبلغ المعدل إلى عملات
            let remaining = adjustedAmount;
            
            // نتائج العملات
            let oldCoinsResult = {};
            let newCoinsResult = {};
            
            // نبدأ بالعملات الجديدة الكبيرة (حولها إلى قيمة قديمة)
            let newCoinsConverted = currencyData.new.map(coin => ({
                name: coin.name,
                value: coin.value * 100,
                originalValue: coin.value,
                type: 'new'
            }));
            
            // دمج العملات القديمة والجديدة (مع تحويل الجديدة)
            let allCoins = [
                ...currencyData.old.map(coin => ({...coin, type: 'old'})),
                ...newCoinsConverted
            ];
            
            // ترتيب العملات تنازلياً حسب القيمة
            allCoins.sort((a, b) => b.value - a.value);
            
            // خوارزمية جشعة لتحويل المبلغ
            for (let coin of allCoins) {
                if (remaining >= coin.value) {
                    let count = Math.floor(remaining / coin.value);
                    remaining = remaining % coin.value;
                    
                    if (coin.type === 'old') {
                        oldCoinsResult[coin.value] = {name: coin.name, count: count};
                    } else {
                        // للعملات الجديدة، نستخدم القيمة الأصلية (الجديدة) للعرض
                        newCoinsResult[coin.originalValue] = {name: coin.name, count: count};
                    }
                }
            }
            
            // إذا بقي باقي بعد التحويل، نستخدم أصغر عملة قديمة (100) لتغطيته
            if (remaining > 0) {
                let smallestOldCoin = currencyData.old.find(coin => coin.value === 100);
                if (smallestOldCoin) {
                    let additionalCount = Math.ceil(remaining / smallestOldCoin.value);
                    if (oldCoinsResult[smallestOldCoin.value]) {
                        oldCoinsResult[smallestOldCoin.value].count += additionalCount;
                    } else {
                        oldCoinsResult[smallestOldCoin.value] = {
                            name: smallestOldCoin.name, 
                            count: additionalCount
                        };
                    }
                    // نعدل المبلغ المتبقي ليصبح صفراً
                    remaining = 0;
                }
            }
            
            return {
                oldCoins: oldCoinsResult,
                newCoins: newCoinsResult,
                originalAmount: amount,
                originalType: isOldCurrency ? 'old' : 'new',
                originalAmountInOld: originalAmountInOld,
                adjustedAmountInOld: adjustedAmount,
                remainder: remainder,
                adjustmentAmount: adjustmentAmount,
                adjustmentType: adjustment,
                hasAdjustment: remainder > 0
            };
        }
        
        function displayMixedResults(result) {
            // عرض المبالغ
            const remainderDisplay = document.getElementById('remainderDisplay');
            const mixedResultBox = document.getElementById('mixedResultBox');
            
            if (result.hasAdjustment) {
                // إظهار قسم الباقي
                remainderDisplay.style.display = 'block';
                
                let adjustmentText = '';
                
                if (result.adjustmentType === 'up') {
                    adjustmentText = `تم جبر الباقي بالزيادة بمقدار ${result.adjustmentAmount.toLocaleString()} ليرة قديمة`;
                    document.getElementById('remainderAmount').textContent = `+${result.adjustmentAmount.toLocaleString()} ليرة قديمة`;
                    document.getElementById('remainderAmount').style.color = 'var(--success-color)';
                } else {
                    adjustmentText = `تم جبر الباقي بالنقصان بمقدار ${result.adjustmentAmount.toLocaleString()} ليرة قديمة`;
                    document.getElementById('remainderAmount').textContent = `-${result.adjustmentAmount.toLocaleString()} ليرة قديمة`;
                    document.getElementById('remainderAmount').style.color = 'var(--primary-color)';
                }
                
                document.getElementById('remainderText').innerHTML = `
                    <p>المبلغ الأصلي: <strong>${result.originalAmount.toLocaleString()} ${result.originalType === 'old' ? 'ليرة قديمة' : 'ليرة جديدة'}</strong></p>
                    <p>${adjustmentText}</p>
                    <p>المبلغ بعد الجبر: <strong>${(result.adjustedAmountInOld / (result.originalType === 'old' ? 1 : 100)).toLocaleString()} ${result.originalType === 'old' ? 'ليرة قديمة' : 'ليرة جديدة'}</strong></p>
                `;
            } else {
                // إخفاء قسم الباقي إذا لم يكن هناك جبر
                remainderDisplay.style.display = 'none';
            }
            
            // عرض المبالغ في المربع الرئيسي
            if (result.originalType === 'old') {
                document.getElementById('inputMixedAmount').textContent = `${result.originalAmount.toLocaleString()} ليرة قديمة`;
                document.getElementById('adjustedMixedAmount').textContent = `${Math.floor(result.adjustedAmountInOld / 100).toLocaleString()} ليرة جديدة`;
            } else {
                document.getElementById('inputMixedAmount').textContent = `${result.originalAmount.toLocaleString()} ليرة جديدة`;
                document.getElementById('adjustedMixedAmount').textContent = `${result.adjustedAmountInOld.toLocaleString()} ليرة قديمة`;
            }
            
            // عرض العملات
            const coinsList = document.getElementById('mixedCoinsList');
            coinsList.innerHTML = '';
            
            let totalOldCount = 0;
            let totalNewCount = 0;
            
            // عرض العملات الجديدة أولاً
            for (let value in result.newCoins) {
                if (result.newCoins[value].count > 0) {
                    totalNewCount += result.newCoins[value].count;
                    
                    const coinItem = document.createElement('div');
                    coinItem.className = 'coin-item new';
                    coinItem.innerHTML = `
                        <div class="coin-name">${result.newCoins[value].name}</div>
                        <div class="coin-count">${result.newCoins[value].count}</div>
                    `;
                    coinsList.appendChild(coinItem);
                }
            }
            
            // عرض العملات القديمة
            for (let value in result.oldCoins) {
                if (result.oldCoins[value].count > 0) {
                    totalOldCount += result.oldCoins[value].count;
                    
                    const coinItem = document.createElement('div');
                    coinItem.className = 'coin-item old';
                    coinItem.innerHTML = `
                        <div class="coin-name">${result.oldCoins[value].name}</div>
                        <div class="coin-count">${result.oldCoins[value].count}</div>
                    `;
                    coinsList.appendChild(coinItem);
                }
            }
            
            // إذا لم توجد عملات، نعرض رسالة
            if (coinsList.children.length === 0) {
                coinsList.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: #95a5a6;">
                        <i class="fas fa-coins" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <p>المبلغ صغير جداً ولا يمكن تحويله إلى عملات</p>
                    </div>
                `;
            }
            
            // تحديث الإحصائيات
            document.getElementById('oldMixedCoinsCount').textContent = totalOldCount;
            document.getElementById('newMixedCoinsCount').textContent = totalNewCount;
            document.getElementById('totalMixedCoinsCount').textContent = totalOldCount + totalNewCount;
            
            // إظهار نتيجة التحويل
            mixedResultBox.style.display = 'block';
        }
        
        // ===== دوال مساعدة =====
        function formatNumber(num) {
            return num.toLocaleString('en-US', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
        }
        
        // ===== دوال PWA والتثبيت =====
        function showInstallPrompt() {
            if (deferredPrompt && !isAppInstalled()) {
                document.getElementById('installPrompt').style.display = 'block';
            }
        }
        
        function closeInstallPrompt() {
            document.getElementById('installPrompt').style.display = 'none';
        }
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('تم تثبيت التطبيق');
                    }
                    deferredPrompt = null;
                });
            }
            closeInstallPrompt();
        }
        
        function isAppInstalled() {
            return window.matchMedia('(display-mode: standalone)').matches || 
                   window.navigator.standalone === true;
        }
        
        function updateOnlineStatus() {
            const offlineStatus = document.getElementById('offlineStatus');
            if (navigator.onLine) {
                offlineStatus.style.display = 'none';
            } else {
                offlineStatus.style.display = 'block';
                offlineStatus.innerHTML = '<i class="fas fa-wifi-slash"></i> تطبيق يعمل بدون إنترنت';
                offlineStatus.style.background = '#2ecc71';
            }
        }
        
        // ===== تهيئة التطبيق عند التحميل =====
        document.addEventListener('DOMContentLoaded', function() {
            // تحديث حالة الاتصال
            updateOnlineStatus();
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            
            // استعادة التبويب النشط من الذاكرة المحلية
            const savedTab = localStorage.getItem('activeTab');
            if (savedTab && document.querySelector(`[data-tab="${savedTab}"]`)) {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                document.querySelector(`[data-tab="${savedTab}"]`).classList.add('active');
                document.getElementById(savedTab).classList.add('active');
                currentTab = savedTab;
            }
            
            // تهيئة التبويب 1
            document.getElementById('conversionType').addEventListener('change', updateLabels);
            document.getElementById('amount').addEventListener('input', calculateSimple);
            initSimpleConverterAdjustment();
            
            // تحديث أولي للتبويب 1
            updateLabels();
            
            // تهيئة التبويب 2
            initCurrencyCalculator();
            
            // تهيئة التبويب 3
            initMixedConverter();
            
            // منع سلوك التحديث عند السحب لأسفل على الهواتف
            let startY;
            document.addEventListener('touchstart', function(e) {
                startY = e.touches[0].clientY;
            }, { passive: true });
            
            document.addEventListener('touchmove', function(e) {
                if (window.scrollY === 0 && e.touches[0].clientY > startY) {
                    e.preventDefault();
                }
            }, { passive: false });
        });
        
        // ===== أحداث PWA =====
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            setTimeout(showInstallPrompt, 3000);
        });
        
        // خدمة Worker للتخزين المؤقت
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js').catch(error => {
                    console.log('Service Worker registration failed:', error);
                });
            });
        }
    </script>
</body>
</html>



